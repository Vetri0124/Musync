{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\Musync\\\\frontend\\\\src\\\\context\\\\AudioContext.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AudioContext = /*#__PURE__*/createContext();\nconst AudioProvider = ({\n  children\n}) => {\n  _s();\n  const [recording, setRecording] = useState(false);\n  const [audioBlob, setAudioBlob] = useState(null);\n  const [result, setResult] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const startRecording = async () => {\n    console.log('Attempting to start recording...');\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: true\n      });\n      const mediaRecorder = new MediaRecorder(stream);\n      const audioChunks = [];\n      mediaRecorder.ondataavailable = e => {\n        audioChunks.push(e.data);\n      };\n      mediaRecorder.onstop = async () => {\n        console.log('Recording stopped. Creating audio blob...');\n        const audioBlob = new Blob(audioChunks, {\n          type: 'audio/wav'\n        });\n        setAudioBlob(audioBlob);\n        stream.getTracks().forEach(track => track.stop());\n        console.log(`Audio Blob created: Type = ${audioBlob.type}, Size = ${audioBlob.size} bytes`); // ADDED LOG\n      };\n      mediaRecorder.start();\n      setRecording(true);\n      setError(null);\n      setResult(null);\n      console.log('Recording started.');\n      return mediaRecorder;\n    } catch (err) {\n      console.error('Error accessing microphone:', err);\n      if (err.name === 'NotAllowedError' || err.name === 'PermissionDeniedError') {\n        setError('Microphone access denied. Please allow microphone permissions in your browser settings.');\n      } else if (err.name === 'NotFoundError') {\n        setError('No microphone found. Please ensure a microphone is connected and working.');\n      } else {\n        setError('Failed to start recording. Please try again.');\n      }\n      setRecording(false);\n      return null;\n    }\n  };\n  const stopRecording = mediaRecorder => {\n    if (mediaRecorder && mediaRecorder.state !== 'inactive') {\n      console.log('Stopping media recorder...');\n      mediaRecorder.stop();\n      setRecording(false);\n    }\n  };\n  const recognizeSong = async () => {\n    if (!audioBlob) {\n      setError('No audio to recognize. Please record first.');\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    setResult(null);\n\n    // ADDED LOGS BEFORE SENDING\n    console.log('Attempting to recognize song...');\n    console.log(`Audio Blob for recognition: Type = ${audioBlob.type}, Size = ${audioBlob.size} bytes`);\n    if (audioBlob.size === 0) {\n      setError('Recorded audio is empty. Please ensure microphone is active during recording.');\n      setLoading(false);\n      return;\n    }\n    try {\n      const formData = new FormData();\n      formData.append('audio', audioBlob, 'recording.wav');\n\n      // You can also inspect formData if needed (for debugging, won't show file content directly)\n      // for (let pair of formData.entries()) {\n      //   console.log(pair[0]+ ', ' + pair[1]);\n      // }\n\n      const res = await axios.post('http://localhost:5000/api/recognize', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n          // This is handled automatically by Axios for FormData, but good to be explicit\n          Authorization: `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n      console.log('Recognition successful:', res.data);\n      setResult(res.data);\n    } catch (err) {\n      var _err$response;\n      console.error('Recognition failed:', ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.data) || err.message);\n      let errorMessage = 'Song recognition failed. Please try again.';\n      if (err.response) {\n        if (err.response.status === 401) {\n          errorMessage = 'Authentication required. Please log in.';\n        } else if (err.response.data && err.response.data.message) {\n          errorMessage = err.response.data.message;\n        } else if (err.response.statusText) {\n          errorMessage = `Error: ${err.response.status} ${err.response.statusText}`;\n        }\n      } else if (err.request) {\n        errorMessage = 'Network error: Could not reach the server. Is your backend running?';\n      }\n      setError(errorMessage);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const reset = () => {\n    console.log('Resetting audio context state...');\n    setAudioBlob(null);\n    setResult(null);\n    setError(null);\n    setRecording(false);\n    setLoading(false);\n  };\n  return /*#__PURE__*/_jsxDEV(AudioContext.Provider, {\n    value: {\n      recording,\n      audioBlob,\n      result,\n      loading,\n      error,\n      startRecording,\n      stopRecording,\n      recognizeSong,\n      reset\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 5\n  }, this);\n};\n_s(AudioProvider, \"+ipqIAooPE+qvUuM/uKFI88n8r4=\");\n_c = AudioProvider;\nexport { AudioContext, AudioProvider };\nvar _c;\n$RefreshReg$(_c, \"AudioProvider\");","map":{"version":3,"names":["React","createContext","useState","axios","jsxDEV","_jsxDEV","AudioContext","AudioProvider","children","_s","recording","setRecording","audioBlob","setAudioBlob","result","setResult","loading","setLoading","error","setError","startRecording","console","log","stream","navigator","mediaDevices","getUserMedia","audio","mediaRecorder","MediaRecorder","audioChunks","ondataavailable","e","push","data","onstop","Blob","type","getTracks","forEach","track","stop","size","start","err","name","stopRecording","state","recognizeSong","formData","FormData","append","res","post","headers","Authorization","localStorage","getItem","_err$response","response","message","errorMessage","status","statusText","request","reset","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/Musync/frontend/src/context/AudioContext.js"],"sourcesContent":["import React, { createContext, useState } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst AudioContext = createContext();\r\n\r\nconst AudioProvider = ({ children }) => {\r\n  const [recording, setRecording] = useState(false);\r\n  const [audioBlob, setAudioBlob] = useState(null);\r\n  const [result, setResult] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const startRecording = async () => {\r\n    console.log('Attempting to start recording...');\r\n    try {\r\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n      const mediaRecorder = new MediaRecorder(stream);\r\n      const audioChunks = [];\r\n\r\n      mediaRecorder.ondataavailable = (e) => {\r\n        audioChunks.push(e.data);\r\n      };\r\n\r\n      mediaRecorder.onstop = async () => {\r\n        console.log('Recording stopped. Creating audio blob...');\r\n        const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });\r\n        setAudioBlob(audioBlob);\r\n        stream.getTracks().forEach(track => track.stop());\r\n        console.log(`Audio Blob created: Type = ${audioBlob.type}, Size = ${audioBlob.size} bytes`); // ADDED LOG\r\n      };\r\n\r\n      mediaRecorder.start();\r\n      setRecording(true);\r\n      setError(null);\r\n      setResult(null);\r\n      console.log('Recording started.');\r\n\r\n      return mediaRecorder;\r\n    } catch (err) {\r\n      console.error('Error accessing microphone:', err);\r\n      if (err.name === 'NotAllowedError' || err.name === 'PermissionDeniedError') {\r\n        setError('Microphone access denied. Please allow microphone permissions in your browser settings.');\r\n      } else if (err.name === 'NotFoundError') {\r\n        setError('No microphone found. Please ensure a microphone is connected and working.');\r\n      } else {\r\n        setError('Failed to start recording. Please try again.');\r\n      }\r\n      setRecording(false);\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const stopRecording = (mediaRecorder) => {\r\n    if (mediaRecorder && mediaRecorder.state !== 'inactive') {\r\n      console.log('Stopping media recorder...');\r\n      mediaRecorder.stop();\r\n      setRecording(false);\r\n    }\r\n  };\r\n\r\n  const recognizeSong = async () => {\r\n    if (!audioBlob) {\r\n      setError('No audio to recognize. Please record first.');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n    setResult(null);\r\n\r\n    // ADDED LOGS BEFORE SENDING\r\n    console.log('Attempting to recognize song...');\r\n    console.log(`Audio Blob for recognition: Type = ${audioBlob.type}, Size = ${audioBlob.size} bytes`);\r\n    if (audioBlob.size === 0) {\r\n      setError('Recorded audio is empty. Please ensure microphone is active during recording.');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('audio', audioBlob, 'recording.wav');\r\n\r\n      // You can also inspect formData if needed (for debugging, won't show file content directly)\r\n      // for (let pair of formData.entries()) {\r\n      //   console.log(pair[0]+ ', ' + pair[1]);\r\n      // }\r\n\r\n      const res = await axios.post('http://localhost:5000/api/recognize', formData, {\r\n        headers: {\r\n          'Content-Type': 'multipart/form-data', // This is handled automatically by Axios for FormData, but good to be explicit\r\n          Authorization: `Bearer ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n\r\n      console.log('Recognition successful:', res.data);\r\n      setResult(res.data);\r\n    } catch (err) {\r\n      console.error('Recognition failed:', err.response?.data || err.message);\r\n      let errorMessage = 'Song recognition failed. Please try again.';\r\n      if (err.response) {\r\n        if (err.response.status === 401) {\r\n          errorMessage = 'Authentication required. Please log in.';\r\n        } else if (err.response.data && err.response.data.message) {\r\n          errorMessage = err.response.data.message;\r\n        } else if (err.response.statusText) {\r\n          errorMessage = `Error: ${err.response.status} ${err.response.statusText}`;\r\n        }\r\n      } else if (err.request) {\r\n        errorMessage = 'Network error: Could not reach the server. Is your backend running?';\r\n      }\r\n      setError(errorMessage);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const reset = () => {\r\n    console.log('Resetting audio context state...');\r\n    setAudioBlob(null);\r\n    setResult(null);\r\n    setError(null);\r\n    setRecording(false);\r\n    setLoading(false);\r\n  };\r\n\r\n  return (\r\n    <AudioContext.Provider value={{\r\n      recording,\r\n      audioBlob,\r\n      result,\r\n      loading,\r\n      error,\r\n      startRecording,\r\n      stopRecording,\r\n      recognizeSong,\r\n      reset\r\n    }}>\r\n      {children}\r\n    </AudioContext.Provider>\r\n  );\r\n};\r\n\r\nexport { AudioContext, AudioProvider };\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}